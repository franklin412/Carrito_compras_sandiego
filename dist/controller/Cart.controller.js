sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/Device","../model/formatter","sap/m/MessageBox"],function(t,e,r,o,a){"use strict";var i="cartProducts";var n="savedForLaterEntries";var s="cartEntries";return t.extend("zsandiego.crearreserva.controller.Cart",{formatter:o,onInit:function(){this._oRouter=this.getRouter();this._oRouter.getRoute("cart").attachPatternMatched(this._routePatternMatched,this);this._oRouter.getRoute("productCart").attachPatternMatched(this._routePatternMatched,this);this._oRouter.getRoute("comparisonCart").attachPatternMatched(this._routePatternMatched,this);var t=new e({});this.getView().setModel(t,"cfg");this._toggleCfgModel();var r=this.byId("editButton");r.addEventDelegate({onAfterRendering:function(){r.focus()}})},onExit:function(){if(this._orderDialog){this._orderDialog.destroy()}if(this._orderBusyDialog){this._orderBusyDialog.destroy()}},_routePatternMatched:function(){this._setLayout("Three");var t=this.getModel("cartProducts");var e=t.getProperty("/cartEntries");if(e.length>0){t.setProperty("/showProceedButton",true);t.setProperty("/showEditButton",true)}var r=this.byId("entryList");r.removeSelections()},onEditOrDoneButtonPress:function(){this._toggleCfgModel()},_toggleCfgModel:function(){var t=this.getView().getModel("cfg");var e=t.getData();var o=this.getResourceBundle();var a=!e.hasOwnProperty("inDelete");var i=a?true:e.inDelete;var n=r.system.phone?"None":"SingleSelectMaster";var s=r.system.phone?"Active":"Inactive";t.setData({inDelete:!i,notInDelete:i,listMode:i?n:"Delete",listItemType:i?s:"Inactive",pageTitle:i?o.getText("appTitle"):o.getText("cartTitleEdit")});var c=this.getOwnerComponent().getModel("cartProducts");c.refresh(true)},onEntryListPress:function(t){this._showProduct(t.getSource())},onEntryListSelect:function(t){this._showProduct(t.getParameter("listItem"))},onSaveForLater:function(t){var e=t.getSource().getBindingContext(i);this._changeList(n,s,e)},onAddBackToBasket:function(t){var e=t.getSource().getBindingContext(i);this._changeList(s,n,e)},_changeList:function(t,e,r){var o=r.getModel();var a=r.getObject();var i=o.getData();var n=Object.assign({},i[t]);var s=Object.assign({},i[e]);var c=a.Item;if(n[c]===undefined){n[c]=Object.assign({},a)}delete s[c];o.setProperty("/"+t,n);o.setProperty("/"+e,s)},_showProduct:function(t){var e=t.getBindingContext(i).getObject();var o=false;if(!r.system.phone){o=this.getModel("appView").getProperty("/layout").startsWith("Three")}else{o=false;this._setLayout("Two")}this._oRouter.navTo(o?"productCart":"product",{id:e.Category,productId:e.ProductId},!r.system.phone)},onCartEntriesDelete:function(t){this._deleteProduct(s,t)},onSaveForLaterDelete:function(t){this._deleteProduct(n,t)},_deleteProduct:function(t,e){var r=e.getParameter("listItem").getBindingContext(i);var o=r.getObject().Item;var n=this.getResourceBundle();a.show(n.getText("cartDeleteDialogMsg"),{title:n.getText("cartDeleteDialogTitle"),actions:[a.Action.DELETE,a.Action.CANCEL],onClose:function(e){if(e!==a.Action.DELETE){return}var i=r.getModel();var n=Object.assign({},i.getData()[t]);delete n[o];i.setProperty("/"+t,Object.assign({},n))}})},onProceedButtonPress:function(){var t=this.getModel("cartProducts");var e=t.getProperty("/cartEntries").length;this.getView().getModel("localmodel").setProperty("/listaProductosCantidad/value",e);this.getRouter().navTo("checkout")}})});