sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/core/UIComponent","sap/ui/core/routing/History","../model/cart","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(t,e,a,i,o,n,r,s){"use strict";return t.extend("zsandiego.carritocompras.controller.BaseController",{cart:o,getRouter:function(){return a.getRouterFor(this)},getModel:function(t){return this.getView().getModel(t)},setModel:function(t,e){return this.getView().setModel(t,e)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},onStateChange:function(t){var e=t.getParameter("layout"),a=t.getParameter("maxColumnsCount");if(a===1){this.getModel("appView").setProperty("/smallScreenMode",true)}else{this.getModel("appView").setProperty("/smallScreenMode",false);if(e==="OneColumn"){this._setLayout("Two")}}},_setLayout:function(t){if(t){this.getModel("appView").setProperty("/layout",t+"Column"+(t==="One"?"":"sMidExpanded"))}},_unhideMiddlePage:function(){setTimeout(function(){this.getOwnerComponent().getRootControl().byId("layout").getCurrentMidColumnPage().removeStyleClass("sapMNavItemHidden")}.bind(this),0)},onBack:function(){this._unhideMiddlePage();var t=i.getInstance();var e=t.getPreviousHash();if(e!==undefined){window.history.go(-1)}else{this.getRouter().navTo("home")}},onAddToCart:function(){var t=this.getView().getModel("localmodel").getProperty("/ProductData");if(!this.oDialogQuantity){this.oDialogQuantity=sap.ui.xmlfragment("zsandiego.carritocompras.view.fragment.addQuantity",this);this.getView().addDependent(this.oDialogQuantity)}sap.ui.getCore().byId("sInpQuantityLabel").setLabel("Cantidad ");sap.ui.getCore().byId("sInpQuantity").setMin(parseFloat(t.Cant_Min));sap.ui.getCore().byId("sInpQuantity").setValue(parseFloat(t.Cant_Min));this.oDialogQuantity.data("oProduct",t);this.oDialogQuantity.open()},onAddQuantity:function(t){var e=t.getSource().getParent().data("oProduct");var a=sap.ui.getCore().byId("sInpQuantity").getValue()*1;var i=this.getModel("i18n").getResourceBundle();var n=this.getModel("cartProducts");var r=this.getView().getModel("localmodel").getData().itemSelected;o.addToCart(i,e,n,a,r);this.cantidad_productos=n.getProperty("/cartEntries").length;this.getView().getModel("localmodel").setProperty("/listaProductosCantidad/value",this.cantidad_productos);this.onCancelQuantity()},onChangeQuantity:function(t){var e=t.getSource();var a=t.getParameter("value");var i=e.getMin();if(a<i){n.warning("La cantidad mÃ­nima permitida es "+e.getMin()+".");e.setValue(i);var o=e.getBinding("value");if(o){setTimeout(function(){o.setValue(i)},1e3)}}},onCancelQuantity:function(t){if(this.oDialogQuantity){this.oDialogQuantity.close();this.oDialogQuantity.destroy();this.oDialogQuantity=null}},_clearComparison:function(){var t=this.getOwnerComponent().getModel("comparison");t.setData({category:"",item1:"",item2:""})},handleSuggest:function(t){var e=t.getSource();var a=e.getBindingInfo("suggestionItems").template;var i=[];var o=t.getParameter("suggestValue");if(o){i.push(new r(a.getBindingPath("text"),s.Contains,o));i.push(new r(a.getBindingPath("additionalText"),s.Contains,o))}t.getSource().getBinding("suggestionItems").filter(new r({filters:i,and:false}));t.getSource().setFilterSuggests(false)}})});