sap.ui.define(["./BaseController","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/core/Fragment","sap/m/MessageBox"],function(e,t,o,r,a,s,n){"use strict";return e.extend("zsandiego.carritocompras.controller.Home",{formatter:t,onInit:function(){var e=this.getOwnerComponent();this._router=e.getRouter();this._router.getRoute("categories").attachMatched(this._onRouteMatched,this);this._catalogo=this.getOwnerComponent().getModel("catalogo");this.localmodel=this.getOwnerComponent().getModel("localmodel");var t=this;var a=new o("Status",r.EQ,"A");this.byId("categoryList").setBusy(true);this.onGetItemServiceLayer();this.consultaEmpleados();var s="zsandiego.carritocompras";this.localmodel.setProperty("/localmodel/lineafragmento",{});this.localmodel.setProperty("/placeholder",jQuery.sap.getModulePath(s)+"/img/11030-200.png")},onBeforeRendering:function(){},onGetItemServiceLayer:function(){var e=this;let t=this.getOwnerComponent().getManifestObject();var o={USRWS:"S4ND!3G0",PWDWS:"1NG.S4ND13G0",CompanyDB:"TEST_QA_102022",Password:"integra",UserName:"manager",Server:"172.31.49.151",ItemCode:"0026592"};var r=sap.ui.component(sap.ui.core.Component.getOwnerIdFor(this.getView()))._oManifest._oBaseUri._parts.path;return new Promise(function(t,o){var a=r+"sb1sl/Items?$skip=50000";$.ajax({type:"GET",dataType:"json",url:a,success:function(o){e.localmodel.setProperty("/catalogosSet",o.value);e.byId("categoryList").setBusy(false);t(o.value)},error:function(e){o(e.responseJSON)}})})},consultaEmpleados:function(){var e=this;var t=sap.ui.component(sap.ui.core.Component.getOwnerIdFor(this.getView()))._oManifest._oBaseUri._parts.path;return new Promise(function(o,r){var a=t+"sb1sl/SalesPersons";$.ajax({type:"GET",dataType:"json",url:a,success:function(t){e.localmodel.setProperty("/empleados",t.value);o(t.value)},error:function(e){r(e.responseJSON)}})})},onAfterRendering:function(){var e="zsandiego.carritocompras";this.getView().byId("imgLogo").setSrc(jQuery.sap.getModulePath(e)+"/img/imageMain.png")},_onRouteMatched:function(){var e=this.getModel("appView").getProperty("/smallScreenMode");if(e){this._setLayout("One")}},onSearch:function(){this._search()},onRefresh:function(){var e=this;var t=new o("Status",r.EQ,"A");this.byId("categoryList").setBusy(true);this.onGetItemServiceLayer();var a=e.byId("categoryList");var s=a.getBinding("items");s.filter(null);this.byId("searchField").setValue()},onBuscar:function(e){var t=[];var a=e.getSource().getValue();if(a&&a.length>0){t.push(new o("Catnr",r.Contains,a.toUpperCase()));t.push(new o("Caktx",r.Contains,a.toUpperCase()))}var s=this.byId("categoryList");var n=s.getBinding("items");if(t.length!==0){n.filter(new o({filters:t,and:false}))}else{n.filter(null)}},_search:function(){var e=this.getView();var t=e.byId("categoryList");var a=[];var s=this.byId("searchField").getValue();if(s&&s.length>0){a.push(new o("Catnr",r.Contains,s.toUpperCase()));a.push(new o("Caktx",r.Contains,s.toUpperCase()))}var n=this.byId("categoryList");var i=n.getBinding("items");i.filter(new o({filters:a,and:false}));i.refresh()},onCategoryListItemPress:function(e){var t=e.getParameter("listItem");var o=t.getBindingContext("localmodel").getObject();var r=o.ItemCode;this._router.navTo("category",{id:r});this._unhideMiddlePage();this.getView().byId("searchField").clear("true")},onProductListSelect:function(e){var t=e.getParameter("listItem");this._showProduct(t)},onProductListItemPress:function(e){var t=e.getSource();this._showProduct(t)},_showProduct:function(e){var t=e.getBindingContext().getObject();this._router.navTo("product",{id:t.Category,productId:t.ProductId},!a.system.phone)},onBack:function(){this.getRouter().navTo("home")}})});